<%- include('header') %>

<div class="card shadow-sm">
    <div class="card-header bg-primary text-white">
        <h3><%= rumor.title %> (ID: <%= rumor.rumor_id %>)</h3>
    </div>
    <div class="card-body">
        <div class="row mb-3">
            <div class="col-md-6">
                <p><strong>‡πÅ‡∏´‡∏•‡πà‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏≤:</strong> <%= rumor.source %></p>
                <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏Ç‡πà‡∏≤‡∏ß:</strong> <%= new Date(rumor.created_at).toLocaleString('th-TH') %></p>
                <p><strong>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏∑‡∏≠:</strong> <span class="fw-bold fs-5"><%= rumor.credibility_score %></span> / 100</p>
            </div>
            <div class="col-md-6">
                <% 
                    let statusText = rumor.status;
                    let badgeClass = 'secondary';
                    if (rumor.status == 'panic') { statusText = 'Panic'; badgeClass = 'danger'; }
                    else if (rumor.status == '‡∏õ‡∏Å‡∏ï‡∏¥') { statusText = '‡∏õ‡∏Å‡∏ï‡∏¥'; badgeClass = 'info text-white'; }
                    else if (rumor.status == 'verified_true') { statusText = '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á'; badgeClass = 'success'; }
                    else if (rumor.status == 'verified_false') { statusText = '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ó‡πá‡∏à'; badgeClass = 'success'; }
                %>
                <p><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:</strong> <span class="badge bg-<%= badgeClass %> fs-6"><%= statusText %></span></p>
                <p><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô:</strong> <span class="fw-bold text-danger"><%= reportCount %></span> ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>
            </div>
        </div>
        
        <hr>
        
        <% if (rumor.status !== 'verified_true' && rumor.status !== 'verified_false') { %>
            <h4 class="mb-3">‡πÅ‡∏à‡πâ‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ç‡πà‡∏≤‡∏ß‡∏•‡∏∑‡∏≠‡∏ô‡∏µ‡πâ</h4>
            <form action="/report" method="post" class="row g-3 bg-light p-3 border rounded">
                <input type="hidden" name="rumor_id" value="<%= rumor.rumor_id %>">
                
                <div class="col-md-4">
                    <label class="form-label">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô (Simulation)</label>
                    <select name="user_id" class="form-select" required>
                        <option value="" disabled selected>-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ö‡∏±‡∏ç‡∏ä‡∏µ --</option>
                        <% users.forEach(function(user) { %>
                            <option value="<%= user.id %>"><%= user.name %></option>
                        <% }); %>
                    </select>
                </div>
                <div class="col-md-4">
                    <label class="form-label">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</label>
                    <select name="report_type" class="form-select">
                        <option value="‡∏ö‡∏¥‡∏î‡πÄ‡∏ö‡∏∑‡∏≠‡∏ô">‡∏ö‡∏¥‡∏î‡πÄ‡∏ö‡∏∑‡∏≠‡∏ô</option>
                        <option value="‡∏õ‡∏•‡∏∏‡∏Å‡∏õ‡∏±‡πà‡∏ô">‡∏õ‡∏•‡∏∏‡∏Å‡∏õ‡∏±‡πà‡∏ô</option>
                        <option value="‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ó‡πá‡∏à">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ó‡πá‡∏à</option>
                    </select>
                </div>
                <div class="col-md-4 align-self-end">
                    <button type="submit" class="btn btn-danger w-100">üö© ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
                </div>
            </form>
        <% } else { %>
            <div class="alert alert-success text-center">
                <h4>‚úÖ ‡∏Ç‡πà‡∏≤‡∏ß‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</h4>
                <p>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: <strong><%= statusText %></strong></p>
            </div>
        <% } %>
    </div>
</div>

<div class="mt-3">
    <a href="/" class="btn btn-secondary">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
</div>

<%- include('footer') %>